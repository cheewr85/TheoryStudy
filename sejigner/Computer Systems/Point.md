# Fixed Point vs Floating Point

컴퓨터는 모든 수를 2진법으로 표현해야하기 때문에 정수를 제외한 실수를 표현하려면 정수와는 다른 방식이 필요하다.고정 소수점(Fixed Point) 방식과 부동 소수점(Floating Point) 방식이 있다.
## Binary Point
소수를 표현할 때는 2진소수점(binary point) 개념이 도입된다. 2진소수점 방식의 수 11010.1는 다음과 같이 구성되어있다.
|2^5^ |2^4^|2^3^ |2^2^ |2^1^ |2^0^ |2^-1^ |2^-2^ |2^-3^ |
| -- |-- |-- |-- |-- |-- |-- |-- |-- |
| ...|1|1|0|1|0|1|0|...|
= 1 * 2^4^  + 1 * 2^3^ + 0 * 2^2^ + 1 * 2^1^  + 0* 2^0^ + 1 * 2^-1^
= 16 + 8 + 2 + 0.5
= 26.5(10진수)
이때, 소수점을 한 자리 밀면,
|2^5^ |2^4^|2^3^ |2^2^ |2^1^ |2^0^ |2^-1^ |2^-2^ |2^-3^ |
| -- |-- |-- |-- |-- |-- |-- |-- |-- |
|1|1|0|1|0|1|0|0|0| 의 구성이 되는데, 이는 53(10진수)이 된다. 한 자리의 비트 이동은 2을 곱하거나 나누는 결과를 불러온다.
---

## Fixed Point
![32비트 실수](/sejigner/img/systems_1.4/point/1.jpg)
실수는 정수부와 소수부로 나뉜다. 정수는 소수부가 존재하지 않고, 정수를 제외한 실수는 정수부에 소수부가 붙게 되는데, 이때 고정 소수점은 소수부의 자릿수를 미리 정한 후, 한정된 자릿수의 소수를 표현하는 방식이다. 즉, 고정 소수점을 정의하려면 수 표현에 사용할 너비와 숫자 사이에 2진소수점의 위치가 필요하다. 이때, 다음과 같은 표기법이 사용된다. fixed<8,4>, 이는 8비트 크기의 고정소수점 수에 뒤 4 자리가 소수부에 속한다는 것을 의미한다. 
|0|0|1|0|0|1|1|0|
|--|--|--|--|--|--|--|--|
= 1 * 2^2^  + 1* 2^-2^ + 1 * 2^-3^
= 4 + 0.25 + 0.125
=4.375 (10진수)

정수와 부동소수점수의 차이는 2진소수점의 위치이다. 2진소수점 뒤에 숫자가 없는 특수한 경우가 정수이다. 즉 2진소수점의 위치가 0인 것이다. 따라서 모든 정수 표현은 고정소수점수로도 나타낼 수 있다. 고정소수점 방식은 정수 계산과 다를 바 없이 직관적이고 효율적이다. 부동소수점보다 빠르다. 그러나 표현할 수 있는 수의 범위가 작아서, 정밀도가 떨어진다. 또한, 전체 크기가 고정되어 있기 때문에 소수부의 범위를 키우면 정수부의 범위가 작아진다.

## Floating Point
부동소수점은 떠다니는 소수점이라는 의미로, 소수점을 이동시켜 표현하는 방식이다. 2진수를 그대로 사용하지 않고, 1.xxx... × 2^n^ 꼴로 변환하는 정규화라는 과정을 거친다.

**IEEE 754**
미국 전기전자기술자협회에서 개발한 표준 부동소수점 표현방법이다.
![IEEE](/sejigner/img/systems_1.4/point/2.jpg)
7.625를 고정소수점으로 표현하면, 111.01이다. 정규화를 거치면 1.1101이 되는데, 맨 앞의 1은 고정이기 때문에 표현을 안해서 hidden bit로 불린다. 소수점 오른쪽에 있는 수는 모두 가수부가 된다. 정규화를 거치면서 소수점이 2자리 당겨졌으니, 111.01를 만들어주려면 지수부에 들어갈 수는 2^2^가 되어야 할 것이다. 이진수로 표현했을 때 10이므로, 지수부에 2(십진, 이진 10)을 넣어줘야할 것 같지만, 표준에서는 이에 bias 값 127을 더해준다. 따라서 2+127 = 129의 이진 표현인 10000001을 넣어준다.
![IEEE](/sejigner/img/systems_1.4/point/3.jpg)

### Bias
0.000101이라는 이진수가 있다면, 정규화된 값은 1.01 × 2^-4^ 일 것이다. Bias가 없다면 이 수를 저장할 방법이 없다. 지수부 0 ~ 147은 음수 지수를 위해, 148 ~ 255는 양수 지수를 위해 사용된다. 즉, 정규화된 값이 1.01 × 2^-146^ 이라 치면, bias 147을 더한 결과인 1의 이진수 1을 지수부에 할당하게 된다. Bias가 더해진 음수 지수는 지수부의 10010011까지 사용하고, 양수 지수는 지수부의 10010100부터 11111111까지를 사용한다.

### 단정도(single-precision)와 배정도(double-precision)
- 32비트는 단정도(single-precision), 64비트는 배정도(double-precision)로 부르며, 32비트에 비해 64비트가 더 나타낼 수 있는 비트가 많아서 근사치의 정확도가 높아진다. 실수형 타입 float가 32비트, double이 64비트에 해당한다. 
- double형은 11비트의 지수부와 53비트의 가수부로 구성된다. 지수부가 11비트이므로 2^11^=2048개의 수를 표현할 수 있고, 그중 0~1023 구간은 음수 지수, 1024 ~ 2047 구간은 양수 지수에 사용된다. 즉, 64비트의 bias는 1023이 된다. 

### Example
**10진수 263.3을 IEEE-754 32비트 부동소수점 표기법으로 표현하기**
- 정수부 263 이진수 변환
	 100000111
- 소수부 0.3 이진수 변환
	|0.3 × 2| 0.6| -> 0|
	|--|--|--|
	|0.6 × 2| 1.2| -> 1|
	|0.2 × 2| 0.4| -> 0|
	|0.4 × 2| 0.8| -> 0|
	|0.8 × 2| 1.6| -> 1|
	|0.6 × 2| 1.2| -> 1|
	|0.2 × 2| 0.4| -> 0|
	|...| ...| -> ...|
	01**0011**00110011...
	263.3 = 100000111.0100110011... (0011 반복)

- 정규화
	263.3 = 1.000001110100110011... × 10^8^
- IEEE 754 표준으로 나타내기
	|x|xxxxxxxx|xxxx...xxxx|
	|--|--|--|
	|sign bit (0:양 / 1:음)|8 exponential bits 지수부|23 fraction bits 가수부|
	|0|bias 127+8=135 -> 1000011|00000111010011001100110|

	|0|1|0|0|0|0|0|1|1|0|0|0|0|0|1|1|1|0|1|0|0|1|1|0|0|1|1|0|0|1|1|0|
	|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|

## Reference
http://www.tcpschool.com/cpp/cpp_datatype_floatingPointNumber
https://inst.eecs.berkeley.edu//~cs61c/sp06/handout/fixedpt.html
https://daldalhanstory.tistory.com/147
https://www.youtube.com/watch?v=8afbTaA-gOQ
> Written with [StackEdit](https://stackedit.io/).
