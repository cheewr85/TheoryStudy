# File System
> 파일: 응용 프로그램을 통해 생성되는 정보의 논리적 단위
> 
> OS의 파일 시스템 : 사용자와 보조기억장치 사이에 인터페이스를 제공하여 파일을 관리하는 운영체제의 기능

## 파일 시스템의 기능
1. 사용자의 파일 생성, 수정, 제거 요청 처리
2. 여러 사용자에게 파일 공유
3. 백업과 복구
4. 주기억장치와 보조기억장치 간 파일 전송
5. 프로그램에 적합한 구조로 파일 구성

## 파일 시스템의 파일 관련 작업
> 파일 단위 작업과 레코드 작업으로 구분

### 파일 단위 작업
- open: 파일을 사용 가능 상태로 준비
- close: 파일에 수정이 있으면 저장하고, 사용 권한 종료
- copy: 데이터를 복사하여 새로운 파일 생성
- destory: 파일을 디스크에서 삭제
- rename: 파일명 변경
- list: 디스크에 저장된 파일 목록 출력

### 레코드 단위 작업
- read: 데이터 읽기
- write: 데이터 쓰기
- update: 데이터 갱신
- insert: 데이터 추가
- delete: 데이터 삭제
- search: 데이터 검색

### 파일 디스크립터 (File Descriptor) / 파일제어블록(File Control Block, FCB)
> 파일을 관리하기 위해 필요한 정보, 메타데이터(metadata) 보관
- 보조기억장치에 있다가 파일이 열릴 때 주기억장치로 이동
- 유저가 직접 참조할 수 없고, 파일 시스템이 관리
- 파일마다 독립적으로 가지고 시스템마다 내용이 다름
- 구성 요소(Metadata)
	- File Permissions
	- File Dates(create, Access, Write)
	- File Owner, Group, ACL
		- ACL(Access Control List): 파일이나 디렉토리와 관련된 권한 허용 리스트
	- File Size
	- File data blocks or pointers to file data blocks

### 디렉토리 (directory)
> 파일 시스템 내부 디스크에 존재하는 파일 정보로 이루어진 테이블
> 파일의 위치, 크기, 할당 방식, 형태, 소유자 등 정보 보관
- 디렉토리 종류
	- 1단계(단일) 디렉토리: 모든 파일이 같은 디렉토리에서 관리되는 간단한 구조
		- 모든 파일명이 달라야 해서 파일 수가 많아질 경우 관리가 어려움
	![디렉토리](/sejigner/img/os/file-system/1.jpg)


	- 2단계 디렉토리: 중앙에 마스터 파일 디렉토리(MFD; Master File Directory), 그 하부에 각 유저에게 할당되는 디렉토리(UFD; UserFile Directory)가 있는 형태
		- 사용자마다 다른 디렉토리 할당
		- 사용자 간 동일한 파일 소유 가능
		- 사용자 이름과 파일 이름을 통해 특정 파일을 명시 -> 긴 파일 이름
		- 사용자 간 파일 공유 불가능
![디렉토리](/sejigner/img/os/file-system/2.jpg)

	- 트리 구조 디렉토리: 하나의 루트 디렉토리와 다수의 서브 디렉토리로 구성
		- 서로 다른 디렉토리 내에서는 동일한 이름의 파일이나 디렉토리 생성 가능
		- 파일 및 디렉터리 탐색은 절대경로, 상대경로 이용
			- 절대 경로: 루트 디렉토리를 기준으로 특정 파일 또는 종속 디렉토리까지 이르는 경로
			- 상대 경로: 현재 디렉토리를 기준으로 특정 파일 또는 디렉토리까지의 경로
		- 디렉터리 생성과 삭제 용이
		- Dos, Windows, Unix 운영체제에서 사용
![디렉토리](/sejigner/img/os/file-system/3.jpg)
	
	- 비순환(비주기) 그래프 디렉토리(Acyclic Graph Directory) : 하위 파일이나 디렉토리의 공유를 허용하면서 사이클이 없는 그래프 구조
		- 하나의 파일이나 디렉토리가 여러 개의 경로 이름 가질 수 있음
		- 단순 트리 구조에 비해 융통성은 좋지만 복잡
		- 공유된 하나의 파일을 탐색할 경우 다른 경로로 두 번 이상 찾아가서 시스템 성능 저하
		- 공유된 파일을 삭제할 경우, 파일은 삭제되어도 그 주소를 여전히 가르키는 고아 포인터(Dangling Pointer) 발생 가능
![디렉토리](/sejigner/img/os/file-system/4.jpg)

	- 일반 그래프 디렉토리: 트리 구조에 링크를 달아 사이클이 허용됨
		- 파일, 디렉토리 공유 가능
		- 그래프 탐색 알고리즘이 간단하여 파일이나 디렉토리 접근 용이
		- 불필요한 파일 제거를 위해 참조 계수기(counter) 사용
		- 제거된 파일의 디스크 공간 확보를 위해 쓰레기 수집 필요
![디렉토리](/sejigner/img/os/file-system/5.jpg)

### 파일 시스템 마운팅(Mounting)
- 파일에 접근하려면, 프로세스가 파일 시스템을 특정 디렉토리에 장착해야 함
- 장착한 장소에 해당하는 디렉토리가 Mount Point
